<!doctype html>
<html lang="en">
  <head>
    <title>Example: Game Screens</title>
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
    <link rel="stylesheet" href="/tic-80-examples/assets/css/vs.min.css">
    <script src="/tic-80-examples/assets/js/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <meta charset="utf-8">
<link rel="shortcut icon" href="/tic-80-examples/favicon.ico" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" />
<!--bootstrap-->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/tic-80-examples/assets/css/style.css">

    <script>
      hljs.highlightAll();
      hljs.initLineNumbersOnLoad();
    </script>
  </head>
  <body class="bg-light">
<a class="github-fork-ribbon" href="https://github.com/cxong/tic-80-examples" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
<div class="container">
  <nav class="navbar navbar-expand-sm">
    <div class="container-fluid">
      <a class="navbar-brand" href="/tic-80-examples/">TIC-80 Examples</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Game Screens</a>
          </li>
        </ul>
        <!-- Hide search for now
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-success" type="submit">Search</button>
        </form>
        -->
    </div>
  </nav>
  <section>
    <iframe id="cart" src="/tic-80-examples/examples/game-screens/moon/index.html" title="Example cart" width="768" height="432"></iframe>

<div class="input-group">
  <pre><code class="code language-moon">-- title:   Game Screens
-- author:  congusbongus
-- desc:    game screens a.k.a. state, timed screens
-- site:    cxong.github.io
-- license: MIT License
-- version: 0.1
-- script:  moon
-- tags:    screen state time menu

WIDTH=240
HEIGHT=136
SFXNEXT=1

-- Base state class
class State
	new:=&gt;
		@tt=0
        -- Set the next state to switch to
		@nextstate=self

	reset:=&gt;
        -- Reset is called whenever the game enters this state
		@tt=0

	update:=&gt;
		@tt+=1

	finish:=&gt;
        -- Finish is called whenever the game exits this state
        return

	next:=&gt;
        -- Returns the next state to switch to, or self to remain in the same state
        return self

	draw:=&gt;return

-- Skip to the next state on any button press.
-- Contains a grace period to avoid accidentally skipping too early
class SkipState extends State
	new:(grace)=&gt;
		super!
		@grace=grace

	finish:=&gt;
		sfx(SFXNEXT)

	next:=&gt;
		if @tt&gt;@grace and (btnp(0) or btnp(1) or btnp(2) or btnp(3) or btnp(4) or btnp(5))
			@finish!
			@nextstate\reset!
			return @nextstate
		return self

-- Example of using SkipState to implement a splash screen
-- This screen is timed which means it wil auto-switch after a length of time
class TimedState extends SkipState
	new:=&gt;
		super(10)
		@len=300

	draw:=&gt;
		super!
		cls(0)
        print("This is the splash screen!", 10, 10, 13)
        print("It will auto-switch in #{math.ceil((@len-@tt)/60)} seconds", 10, 30, 13)

	next:=&gt;
		if @tt&gt;=@len
			@finish!
			@nextstate\reset!
			return @nextstate
		return super!

-- Example of using SkipState to implement a title screen
class TitleState extends SkipState
	new:=&gt;
		super(10)

	draw:=&gt;
		super!
		cls(1)
		print("This is the title screen!\nPress any key to go back to the\nsplash screen", 10, 10, 11)

splashState = TimedState!
titleState = TitleState!
splashState.nextstate = titleState
titleState.nextstate = splashState
state=splashState
state\reset!

export TIC=-&gt;
	state\update!
	state\draw!
	state=state\next!

-- <WAVES>
-- 000:01358acefeca853101368acefeca8531
-- 001:0123456789abcdeffedcba9876543210
-- 002:0123456789abcdef0123456789abcdef
-- </WAVES>

-- <SFX>
-- 000:00000000000000001000300040004000500050007000700090009000a000a000c000d000e000e000f000e000e000e000e000e000e000e000e000e000377000000000
-- 001:0100417061c09100a100c100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100f100450000000300
-- </SFX>

-- <SCREEN>
-- 010:0000000000dddd0dd0000dd00000000000dd000000000000dd000dd00000000000000000000000000dd000000000000000dd00000000000000000000000000000000000000000000dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 011:00000000000dd00dddd000000dddd000000000dddd00000ddddd0dddd000ddd0000000dddd0dddd00dd0000dddd00dddd0dddd0000000dddd00dddd0dddd000ddd000ddd00dddd00dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 012:00000000000dd00dd00d0dd0ddd0000000dd0ddd00000000dd000dd00d0dd0dd00000ddd000dd00d0dd000d00dd0ddd000dd00d00000ddd000ddd000dd00d0dd0dd0dd0dd0dd00d0dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 013:00000000000dd00dd00d0dd000ddd00000dd000ddd000000dd000dd00d0ddd000000000ddd0dd00d0dd000d00dd000ddd0dd00d0000000ddd0ddd000dd0000ddd000ddd000dd00d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 014:00000000000dd00dd00d0dd0dddd000000dd0dddd00000000ddd0dd00d00ddd000000dddd00dddd000ddd00dddd0dddd00dd00d00000dddd000dddd0dd00000ddd000ddd00dd00d0dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 015:000000000000000000000000000000000000000000000000000000000000000000000000000dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
-- 030:0000000000dddd00dd0000000000000dd0dd000dd00000000000000000000dd0000000000000000000000000dd00dd000000000dd00000000dd000000000000dd000000000000000000000000000000000000000dd0000000000000000000000000000000000000000000000000000000000000000000000
-- 031:00000000000dd00ddddd00000d000d0000dd000dd00000000dddd0dd00d0ddddd00ddd0000000dddd0d000d0000ddddd00dddd0dddd000000000dddd000000ddd0000000dddd00ddd000dddd00ddd00dddd000dddd00dddd0000000000000000000000000000000000000000000000000000000000000000
-- 032:00000000000dd000dd0000000d0d0d0dd0dd000dd0000000d00dd0dd00d00dd000dd00d0ddd0ddd000d0d0d0dd00dd000ddd000dd00d00000dd0dd00d000000dd000000ddd000dd0dd0ddd000dd00d0dd00d0d00dd0ddd000000000000000000000000000000000000000000000000000000000000000000
-- 033:00000000000dd000dd0000000ddddd0dd0dd000dd0000000d00dd0dd00d00dd000dd00d0000000ddd0ddddd0dd00dd000ddd000dd00d00000dd0dd00d000000dd00000000ddd0ddd000ddd000dd00d0dd00d0d00dd000ddd0000000000000000000000000000000000000000000000000000000000000000
-- 034:0000000000dddd000ddd00000dd0dd0dd00ddd00ddd000000dddd00ddd0000ddd00ddd000000dddd00dd0dd0dd000ddd00dddd0dd00d00000dd0dd00d00000dddd00000dddd000ddd000dddd00ddd00dd00d00dddd0dddd00000000000000000000000000000000000000000000000000000000000000000
-- </SCREEN>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffcd75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

</code></pre>
</div>

  </section>
</div>
<footer class="footer bg-body">
  <div class="row">
    <span class="text-muted">&copy; <a href="https://cxong.github.io">congusbongusgames</a></span>
  </div>
</footer>
</body>
</html>
